{% extends "inline/base.html" %}
{% load my_tags %}

{% block stats-class %}{% spaceless %}
    {% if request.user.is_authenticated %}
    {% with count=solved|get:problem_set.id %}
    {% if count == 100 %}success{% endif %}
    {% if count < 100 and count >= 50 %}warning{% endif %}
    {% if count < 50 %}error{% endif %}
    {% endwith %}
    {% endif %}
{% endspaceless %}{% endblock %}

{% block stats %}{% spaceless %}
    {% if request.user.is_authenticated %}
        {% with count=solved|get:problem_set.id %}
        {{ count }}<small>%</small>
        {% endwith %}
    {% else %}
        {% with count=problem_set.problems.count %}
        {{ count }}
        <small>
        {% if count == 0 %}
           nalog
        {% endif %}
        {% if count == 1 %}
           naloga
        {% endif %}
        {% if count == 2 %}
           nalogi
        {% endif %}
        {% if count == 3 or count == 4 %}
           naloge
        {% endif %}
        {% if count >= 5 %}
           nalog
        {% endif %}
        </small>
        {% endwith %}{% endif %}
{% endspaceless %}{% endblock %}

{% block title %}
    <a href="{% url problem_set problem_set.id %}">
        {{ problem_set.title }}
    </a>
    {% if not problem_set.visible %}
        (skrit)
    {% endif %}
{% endblock %}

{% block actions %}
    {% if user.is_authenticated %}
        <a href="{% url download_problem_set problem_set.id %}">Prenesi naloge</a>
        {% if request.user.is_staff %}
        <a href="">Uredi datoteke</a>
        <a href="{% url admin:course_problemset_change problem_set.id %}">Uredi sklop</a>
        <a href="{% url admin:course_problemset_delete problem_set.id %}">Pobriši sklop</a>
        {% endif %}
    {% else %}
      <div id="modal-from-dom-{{ problem_set.id }}" class="modal hide fade">
        <div class="modal-header">
          <a href="#" class="close">&times;</a>
          <h3>Za reševanje se najprej prijavite.</h3>
        </div>
        <div class="modal-body">
          <p>
            Če se ne morete prijaviti, lahko naloge rešujete z začasnimi datotekami.
            V tem primeru se vaše rešitve <strong>ne bodo shranile na strežnik</strong>.
            Ko se boste lahko spet prijavili, boste naloge morali ponovno prenesti ter vanje prepisati začasne rešitve.
          </p>
        </div>
        <div class="modal-footer">
          <a href="{% url download_problem_set problem_set.id %}" class="btn secondary">Prenesite začasne datoteke</a>
        </div>
      </div>

      <a data-controls-modal="modal-from-dom-{{ problem_set.id }}" data-backdrop="true" data-keyboard="true" href="#">Prenesi naloge</a>
    {% endif %}
{% endblock %}
