{% extends 'modal.html' %}
{% load my_tags %}

{% block title %}
  Brisanje sklopa {{ object.title }}
{% endblock %}

{% block contents %}
<p>Ste prepričani, da želite pobrisati sklop <em>{{ object.title }}</em>?</p>

<div class="well">
  {{ object.description|tex_markdown|safe|truncatewords_html:50 }}
    {% for problem in object.problems.all %}
      <h3>
        {{ problem.title }}
      </h3>
    {{ problem.description|tex_markdown|safe|truncatewords_html:30 }}

     {% for part in problem.parts.all %}
        <div class="part">
          <h4>
            Podnaloga {{ forloop.counter }}
          </h4>
          <div id="part-{{ part.id }}">
            {{ part.description|tex_markdown|safe|truncatewords_html:10 }}
          </div>
        </div>
    {% endfor %}
   {% endfor %}
</div>

{% if exists %}

  <p>Hkrati s sklopom bodo pobrisani tudi naslednji poskusi in njihova celotna zgodovina:</p>

  {% for problem, problem_attempts in attempts %}
  <h3>
    Naloga {{ forloop.counter }}
    {% if problem.title %} &mdash; {{ problem.title }}{% endif %}
  </h3>
  {% if problem_attempts %}
  <table class="table table-striped table-bordered table-condensed">
    <thead>
      <tr>
        <th colspan="{{ problem.parts.count }}">&nbsp;</th>
        <th>Ime in priimek</th>
        <th>Čas zadnje oddaje</th>
      </tr>
    </thead>

    <tbody>
      {% for user, timestamp, user_attempts in problem_attempts %}
        <tr>
          {% for att in user_attempts %}
            <td>{% if att %}<img src="{{ STATIC_URL }}img/{% if att.correct %}correct{% else %}incorrect{% endif %}.png">{% endif %}</td>
          {% endfor %}
          <td>{{ user.get_full_name }}</td>
          <td>{{ timestamp }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p>Za nalogo zaenkrat še ni bilo opravljenega nobenega poskusa.</p>
  {% endif %}
  {% endfor %}

{% else %}

  <p>V sklopu zaenkrat še ni bilo opravljenega nobenega poskusa.</p>

{% endif %}

{% endblock %}

{% block footer %}
  <form action="" method="post">
    {% csrf_token %}
    <button type="submit" class="btn btn-danger">Pobriši</button>
  </form>
{% endblock %}